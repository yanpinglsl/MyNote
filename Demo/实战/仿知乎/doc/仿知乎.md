# 需求分析

> 项目说明与需求分析

项目说明：仿知乎问答系统

需求分析：

![1-页面整理](images/1-页面整理.png)

# 系统用例图

>  使用系统用例图梳理业务流程

![2-系统用例](images/2-系统用例.jpg)

# 整洁架构

> 使用领域驱动设计的整洁架构

参照文档《DDD基础》

整洁架构的代码分层设计：

![3-代码分层](images/3-代码分层.jpg)

# 实体类图

> 设计领域模型—确定聚合边界和实体设计

![4-实体类图](images/4-实体类图.jpg)

## 实现

**实现领域模型规范**

**实现实体基类与审计实体**

**实现用户聚合中的实体设计**

（1）用户属性中为什么没有包含用户名，密码之类的信息

因为在DDD中，用户的业务功能（关注与用户相关的业务逻辑、围绕用户的业务活动）和用户的登录/身份认证（系统安全层面，如何确保用户的身份真实性、保护用户的数据、实现用户权限的控制）通常被划分在不同聚合中。用户的登录/身份认证属于通用域，而非核心域。

**实现问答聚合中的实体设计**

**实现集成数据访问框架**

**实现数据初始化基础设施服务**

使用了Bogus框架，在测试环境下，生成种子数据

**实现审计属性自动设置**

审计属性自动设置：

- 应用代码中设置

  （1）在业务逻辑相关的处理中手动设置。这种方式会导致审计属性与业务代码紧密耦合，不易于后期维护

  （2）使用数据访问框架实现审计属性自动设置（建议）。此处使用EF Core中SaveChangesInterceptor拦截器实现

- 使用数据库特性自动设置

  缺乏灵活性，调用数据库函数实现；可能会导致并发问题；不可跨数据库迁移（因为一些数据库可能不支持时间戳特性）

**实现命令查询职责模式**

**实现用户注册用例和身份服务**

**实现通用结果返回与通用仓储**

**实现用户注册接口**

**实现  JWT 访问令牌**

**实现用户登录用例与接口**